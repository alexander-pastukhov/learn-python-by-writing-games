<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<link rel="alternate" hreflang="en" href="https://alexander-pastukhov.github.io/learn-python-by-writing-games/09-flappy-bird.html">
<link rel="alternate" hreflang="de" href="https://alexander-pastukhov.github.io/learn-python-by-writing-games/de/09-flappy-bird.de.html">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>9  Flappy Bird – Learn Python by Writing Games</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><meta name="quarto:offset" content="./">
<link href="./10-guitar-hero.html" rel="next">
<link href="./08-christmas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/videojs/video.min.js"></script><link href="site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-flappy-bird.html"><span class="chapter-number">9</span>  <span class="chapter-title">Flappy Bird</span></a></li></ol></nav><a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Learn Python by Writing Games</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="dropdown" id="languages-links-parent">
<button class="btn btn-primary dropdown-toggle language-selector" type="button" data-bs-toggle="dropdown" aria-expanded="false" id="languages-button"><i class="bi bi-globe2"></i></button><ul class="dropdown-menu" id="languages-links"><li><a class="dropdown-item" href="https://alexander-pastukhov.github.io/learn-python-by-writing-games/de/09-flappy-bird.de.html" id="language-link-de">Deutsch</a></li></ul>
</div>
<div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./001-software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002-programming-tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming tips and tricks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>  <span class="chapter-title">Python basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-guess-the-number-single-round.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>  <span class="chapter-title">Guess the Number: a single round edition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-guess-the-number-multi-round.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>  <span class="chapter-title">Guess the Number: a multi round edition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-guess-the-number-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>  <span class="chapter-title">Guess the Number: AI takes a turn</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-psychopy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>  <span class="chapter-title">Gettings started with PsychoPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-whack-a-mole.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>  <span class="chapter-title">Whack-a-Mole</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-memory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>  <span class="chapter-title">Memory game</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-christmas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>  <span class="chapter-title">Christmas special</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-flappy-bird.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>  <span class="chapter-title">Flappy Bird</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-guitar-hero.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>  <span class="chapter-title">Guitar Hero</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#chapter-concepts" id="toc-chapter-concepts" class="nav-link active" data-scroll-target="#chapter-concepts"><span class="header-section-number">9.1</span> Chapter concepts</a></li>
  <li>
<a href="#object-oriented-programming" id="toc-object-oriented-programming" class="nav-link" data-scroll-target="#object-oriented-programming"><span class="header-section-number">9.2</span> Object-oriented programming</a>
  <ul class="collapse">
<li><a href="#classes-and-objects-instances-of-classes" id="toc-classes-and-objects-instances-of-classes" class="nav-link" data-scroll-target="#classes-and-objects-instances-of-classes"><span class="header-section-number">9.2.1</span> Classes and objects (instances of classes)</a></li>
  <li><a href="#encapsulation" id="toc-encapsulation" class="nav-link" data-scroll-target="#encapsulation"><span class="header-section-number">9.2.2</span> Encapsulation</a></li>
  <li><a href="#inheritance-generalization" id="toc-inheritance-generalization" class="nav-link" data-scroll-target="#inheritance-generalization"><span class="header-section-number">9.2.3</span> Inheritance / Generalization</a></li>
  <li><a href="#polymorphism" id="toc-polymorphism" class="nav-link" data-scroll-target="#polymorphism"><span class="header-section-number">9.2.4</span> Polymorphism</a></li>
  <li><a href="#a-minimal-class-example" id="toc-a-minimal-class-example" class="nav-link" data-scroll-target="#a-minimal-class-example"><span class="header-section-number">9.2.5</span> A minimal class example</a></li>
  <li><a href="#add-method" id="toc-add-method" class="nav-link" data-scroll-target="#add-method"><span class="header-section-number">9.2.6</span> <code>add</code> method</a></li>
  <li><a href="#flexible-accumulator-with-a-subtract-method" id="toc-flexible-accumulator-with-a-subtract-method" class="nav-link" data-scroll-target="#flexible-accumulator-with-a-subtract-method"><span class="header-section-number">9.2.7</span> Flexible accumulator with a <code>subtract</code> method</a></li>
  </ul>
</li>
  <li>
<a href="#method-arguments" id="toc-method-arguments" class="nav-link" data-scroll-target="#method-arguments"><span class="header-section-number">9.3</span> Method arguments</a>
  <ul class="collapse">
<li><a href="#constructor-arguments" id="toc-constructor-arguments" class="nav-link" data-scroll-target="#constructor-arguments"><span class="header-section-number">9.3.1</span> Constructor arguments</a></li>
  <li><a href="#calling-methods-from-other-methods" id="toc-calling-methods-from-other-methods" class="nav-link" data-scroll-target="#calling-methods-from-other-methods"><span class="header-section-number">9.3.2</span> Calling methods from other methods</a></li>
  <li><a href="#local-variables" id="toc-local-variables" class="nav-link" data-scroll-target="#local-variables"><span class="header-section-number">9.3.3</span> Local variables</a></li>
  </ul>
</li>
  <li><a href="#flappy-bird-the-humble-beginnings" id="toc-flappy-bird-the-humble-beginnings" class="nav-link" data-scroll-target="#flappy-bird-the-humble-beginnings"><span class="header-section-number">9.4</span> Flappy Bird: the humble beginnings</a></li>
  <li><a href="#flappy-bird-class" id="toc-flappy-bird-class" class="nav-link" data-scroll-target="#flappy-bird-class"><span class="header-section-number">9.5</span> Flappy Bird class</a></li>
  <li><a href="#a-properly-sized-bird" id="toc-a-properly-sized-bird" class="nav-link" data-scroll-target="#a-properly-sized-bird"><span class="header-section-number">9.6</span> A properly-sized bird</a></li>
  <li><a href="#flappy-bird-is-falling-down-my-dear-lady" id="toc-flappy-bird-is-falling-down-my-dear-lady" class="nav-link" data-scroll-target="#flappy-bird-is-falling-down-my-dear-lady"><span class="header-section-number">9.7</span> Flappy Bird is falling down (my dear lady)</a></li>
  <li><a href="#timing-the-fall" id="toc-timing-the-fall" class="nav-link" data-scroll-target="#timing-the-fall"><span class="header-section-number">9.8</span> Timing the fall</a></li>
  <li><a href="#it-is-all-newtons-fault" id="toc-it-is-all-newtons-fault" class="nav-link" data-scroll-target="#it-is-all-newtons-fault"><span class="header-section-number">9.9</span> It is all Newton’s fault</a></li>
  <li><a href="#flap-bird-flap" id="toc-flap-bird-flap" class="nav-link" data-scroll-target="#flap-bird-flap"><span class="header-section-number">9.10</span> Flap bird, flap!</a></li>
  <li><a href="#stay-off-the-ground" id="toc-stay-off-the-ground" class="nav-link" data-scroll-target="#stay-off-the-ground"><span class="header-section-number">9.11</span> Stay off the ground</a></li>
  <li><a href="#computed-attribute-property" id="toc-computed-attribute-property" class="nav-link" data-scroll-target="#computed-attribute-property"><span class="header-section-number">9.12</span> Computed attribute <code>@property</code></a></li>
  <li><a href="#an-opening-in-an-obstacle" id="toc-an-opening-in-an-obstacle" class="nav-link" data-scroll-target="#an-opening-in-an-obstacle"><span class="header-section-number">9.13</span> An opening in an obstacle</a></li>
  <li><a href="#an-obstacle" id="toc-an-obstacle" class="nav-link" data-scroll-target="#an-obstacle"><span class="header-section-number">9.14</span> An obstacle</a></li>
  <li><a href="#a-moving-obstacle" id="toc-a-moving-obstacle" class="nav-link" data-scroll-target="#a-moving-obstacle"><span class="header-section-number">9.15</span> A moving obstacle</a></li>
  <li><a href="#hitting-the-wall" id="toc-hitting-the-wall" class="nav-link" data-scroll-target="#hitting-the-wall"><span class="header-section-number">9.16</span> Hitting the wall</a></li>
  <li><a href="#an-obstacle-manager" id="toc-an-obstacle-manager" class="nav-link" data-scroll-target="#an-obstacle-manager"><span class="header-section-number">9.17</span> An obstacle manager</a></li>
  <li><a href="#loads-of-obstacles" id="toc-loads-of-obstacles" class="nav-link" data-scroll-target="#loads-of-obstacles"><span class="header-section-number">9.18</span> Loads of obstacles</a></li>
  <li><a href="#removing-redundant-obstacles" id="toc-removing-redundant-obstacles" class="nav-link" data-scroll-target="#removing-redundant-obstacles"><span class="header-section-number">9.19</span> Removing redundant obstacles</a></li>
  <li><a href="#keeping-the-score" id="toc-keeping-the-score" class="nav-link" data-scroll-target="#keeping-the-score"><span class="header-section-number">9.20</span> Keeping the score</a></li>
  <li><a href="#a-foundation" id="toc-a-foundation" class="nav-link" data-scroll-target="#a-foundation"><span class="header-section-number">9.21</span> A foundation</a></li>
  </ul></nav>
</div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">9</span>  <span class="chapter-title">Flappy Bird</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Today we will stat developing a <em>Flappy Bird</em> game. You control a bird that must fly through the openings in the obstacles but your only action is to “flap the wings” in order to counteract the effect of gravity. This is how the game will look like at the end.</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="videos/flappy-bird.m4v"></source></video></div>
<section id="chapter-concepts" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="chapter-concepts">
<span class="header-section-number">9.1</span> Chapter concepts</h2>
<ul>
<li>Object-oriented programming</li>
<li>Computed properties of objects: <code>@property</code>
</li>
</ul>
<p>We will use this game as an opportunity to learn more about object-oriented programming. You already know how to use classes, now you get to create them and see how it makes your life easier.</p>
</section><section id="object-oriented-programming" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="object-oriented-programming">
<span class="header-section-number">9.2</span> Object-oriented programming</h2>
<p>The core idea is in the name: Instead of having variables/data and functions separately, you combine them in an object that has attributes/properties (its own variables) and methods (functions). This approach uses our natural tendency to perceive the world as a collection of interacting objects and has several advantages that I will discuss below.</p>
<section id="classes-and-objects-instances-of-classes" class="level3" data-number="9.2.1"><h3 data-number="9.2.1" class="anchored" data-anchor-id="classes-and-objects-instances-of-classes">
<span class="header-section-number">9.2.1</span> Classes and objects (instances of classes)</h3>
<p>Before we continue, I need to make an important distinction between <em>classes</em> and <em>objects</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. A <em>class</em> is a “blue print” that describes properties and behavior (methods) of objects of that class. This “blue print” is used to create an <em>instance</em> of that class, which is called an <em>object</em>. For example, Homo sapiens is a <em>class</em> that describes species that have certain properties, such as height, and can do certain things, such as running. However, Homo sapiens as a class only has a concept of height but no specific height itself. E.g., you cannot ask “What is height of Homo sapiens?” only what is an average (mean, median, etc.) height of individuals of that class. Similarly, you cannot say “Run, Homo sapiens! Run!” as abstract concepts have trouble with real actions like that. Instead, it is Alexander Pastukhov who is an <em>instance</em> of Homo sapiens class with a specific (average) height and a specific (below average) ability to run. Other instances of Homo sapiens (other people) will have different height and a different (typically better) ability to run. Thus, class describes what kind of properties and methods objects have. This means that whenever you meet a Homo sapien, you could be sure that they have height. However, individual objects have different values for various properties and so calling their methods (asking them to perform certain actions) may result in different outcomes.</p>
<p>Another, a more applied, example would be your use of <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> <em>class</em> to create multiple <em>instances</em> of front side of a card in <a href="memory-game">Memory</a> game. Again, the <em>class</em> defines properties (<code>image</code>, <code>pos</code>, <code>size</code>, etc.) and methods (e.g., method <code>draw()</code>) that individual <em>objects</em> will have. You created these objects to serve as front side of cards. You set <em>different</em> values for same properties (<code>image</code>, <code>pos</code>) and that ensured that when you call their method <code>draw()</code>, each card was drawn at its own location and with it own image.</p>
</section><section id="encapsulation" class="level3" data-number="9.2.2"><h3 data-number="9.2.2" class="anchored" data-anchor-id="encapsulation">
<span class="header-section-number">9.2.2</span> Encapsulation</h3>
<p>Putting all the data (properties) and behavior (methods) inside the class simplifies programming by ensuring that all relevant information can be found in its definition. Thus, you have a single place that should hold <em>everything</em> that defines object’s behavior. Contrast this with our approach in previous seminars where cards as dictionaries were separate from functions that created them. Today, you will see how encapsulating everything into classes turns this mess into a simpler and easier-to-understand code.</p>
</section><section id="inheritance-generalization" class="level3" data-number="9.2.3"><h3 data-number="9.2.3" class="anchored" data-anchor-id="inheritance-generalization">
<span class="header-section-number">9.2.3</span> Inheritance / Generalization</h3>
<p>In object-oriented programming, a class can be derived from some <em>ancestor</em> class and thus <em>inherit</em> its properties and methods. Moreover, several classes can be derived from a single ancestor producing a mix of unique and shared functionality. This means that instead of rewriting the same code for each class, you can define a common code in an ancestor class and focus on differences or additional methods and properties in descendants.</p>
<p>Using the Homo sapiens example from above. Humans, chimpanzees and gorillas are all different species but we share a common ancestor. Hence, we are different in many respect, yet, you could think about all of us as “apes” that have common properties such as binocular trichromatic vision. In other words, if you are interested in color vision, you do not care what specific species you are looking it, as all apes are (roughly) the same in that respect. Or, you can move further down the evolution tree and think about us as “mammals” that, again, have common properties and behavior, such as thermoregulation and lactation. Again, if you are interested <em>only</em> in whether an animal has thermoregulation, knowing that it is a mammal is enough.</p>
<p>Similarly, in PsychoPy various visual stimuli that we used (<a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a>, <a href="https://psychopy.org/api/visual/textstim.html#psychopy.visual.TextStim">TextStim</a>, <a href="https://psychopy.org/api/visual/rect.html#psychopy.visual.rect.Rect">Rect</a>) have same properties (e.g., <code>pos</code>, <code>size</code>, etc.) and methods (most notably, <code>draw()</code>). This is because they are all descendants from a common ancestor <code>BaseVisualStim</code> that defines their common properties and methods<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. This means that you can assume that <em>any</em> visual stimulus (as long as it descends from <code>BaseVisualStim</code>) will have <code>size</code>, <code>pos</code>, <code>ori</code> and can be drawn. This, in turn, means that you can have a list of various PsychoPy visual stimuli and move or draw all of them in a single loop without thinking which <em>specific</em> visual stimulus you are moving or drawing. Also note that you cannot assume these same properties for <em>sound</em> stimuli because they are <em>not</em> descendants of <code>BaseVisualStim</code> but of <code>_SoundBase</code> class.</p>
<p>There are other ways of achieving common behavior (generalization) in Python without orderly inheritance, such as “duck typing”<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> or mixins but this will be a topic of another chapter.</p>
</section><section id="polymorphism" class="level3" data-number="9.2.4"><h3 data-number="9.2.4" class="anchored" data-anchor-id="polymorphism">
<span class="header-section-number">9.2.4</span> Polymorphism</h3>
<p>As you’ve learned in the previous section, inheritance allows different descendants to share common properties and behavior, so that in certain cases you can view them as being equivalent to an ancestor. E.g., any visual stimulus (a descendant of <code>BaseVisualStim</code> class) can be drawn, so you just call its <code>draw()</code> method. However, it is clear that these different stimuli implement drawing <em>differently</em>, as the <a href="https://psychopy.org/api/visual/rect.html#psychopy.visual.rect.Rect">Rect</a> stimulus looks different from the <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> or <a href="https://psychopy.org/api/visual/textstim.html#psychopy.visual.TextStim">TextStim</a>. This is called “polymorphism” and the idea is to keep the common interface (same <code>draw()</code> call) while abstracting away the actual implementation. This allows you to think about what you want an object to do (or what to do with an object), instead of thinking how exactly it is implemented.</p>
</section><section id="a-minimal-class-example" class="level3" data-number="9.2.5"><h3 data-number="9.2.5" class="anchored" data-anchor-id="a-minimal-class-example">
<span class="header-section-number">9.2.5</span> A minimal class example</h3>
<p>Enough of the theory, let us see how classes are implemented in Python. Here is a very simple class that has nothing but the <em>constructor</em> <code>__init__()</code> method, which is called whenever a new object (class instance) is created, and a single attribute / property <code>total</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Accumulator:</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Simple class that accumulates (sums up) values.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Attributes</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    total : float</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Total accumulated value</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">        Constructor, initializes the total value to zero.</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># here we create an object number_sum, which is an instance of class Accumulator.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>number_sum <span class="op">=</span> Accumulator()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(number_sum.total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s go through it line by line. First line <code>class Accumulator:</code> shows that this is a declaration of a <code>class</code> whose name is <code>Accumulator</code>. Note that the first letter is capitalized. This is not required per se, so Python police won’t be knocking on your door if you write it all in lower or upper case. However, the general recommendation is that <strong>class</strong> names are written using <code>UpperCaseCamelCase</code> whereas <strong>object</strong> (instances of the class) names are written using <code>lower_case_snake_case</code>. This makes distinguishing between classes and objects (instances of classes) easier, so you should follow this convention.</p>
<p>The definition of the class are the remaining <em>indented</em> lines. As with functions or loops, it is the indentation that defines what is inside and what is outside of the class. The only method we defined is <code>def __init__(self):</code>. This is a <em>special</em> method<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> that is called when an object (instance of the class) is created. This allows you to initialize the object based on parameters that were passed to this function (if any). You do not call this function directly, rather it is called whenever an object is created, e.g., <code>number_sum = Accumulator()</code> (last line). Also, it does not return any value explicitly via <code>return</code>. Instead, <code>self</code> (the very first parameter, more on it below) is returned automatically.</p>
<p>All class methods (apart from special cases we currently do not concern ourselves with) must have one special first parameter that is <em>the object</em> itself. By convention it is called <code>self</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. It is passed to the method automatically, so whenever you write <code>square.draw()</code> (no explicit parameters written in the function call), the actual method still receives one parameter that is the <em>reference</em> to the <code>square</code> variable whose method you called. Inside a method, you use this variable to refer to the object itself.</p>
<p>Let us go back to the constructor <code>__init()__</code> to see how you can use <code>self</code>. Here, we add a new <em>persistent</em> attribute/property to the object and assign a value to it: <code>self.total = 0</code>. It is <em>persistent</em>, because even though we created it inside the method, the mutable object is passed by reference and, therefore, we assigned it to the object itself. Now you can use this property either from inside <code>self.total</code> or from outside <code>number_sum.total</code>. You can think of properties as being similar to field/value pairs in the dictionary we used in Memory game but for syntax: <code>object.property</code> versus <code>dictonary["field"]</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. Technically, you can create new properties in any method or even from outside (e.g., nothing prevents you from writing <code>number_sum.color = "red"</code>). However, this makes understanding the code much harder, so the general recommendation is to create <em>all</em> properties inside the constructor <code>__init__()</code> method, even if this means assigning <code>None</code> to them<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
</section><section id="add-method" class="level3" data-number="9.2.6"><h3 data-number="9.2.6" class="anchored" data-anchor-id="add-method">
<span class="header-section-number">9.2.6</span> <code>add</code> method</h3>
<p>Let us add a method that adds 1 to the <code>total</code> property.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Accumulator:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    ... <span class="co"># I am skipping all previous code here</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add(<span class="va">self</span>):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Add 1 to total</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.total <span class="op">+=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It has first special argument <code>self</code> that is the object itself and we simply add 1 to its <code>total</code> property. Again, remember that <code>self</code> is passed automatically whenever you call the method, meaning that an actual call looks like <code>number_sum.add()</code>.</p>
<p>Create a Jupyter notebook (you will need to submit it as part of the assignment) and copy-paste the code for <code>Accumulator</code> class, including the <code>.add()</code> method. Create <strong>two</strong> objects, call them <code>counter1</code> and <code>counter2</code>. Call <code>.add()</code> method twice for <code>counter2</code> and thrice for <code>counter1</code> (bonus: do it using <code>for</code> loop). What is the value of the <code>.total</code> property of each object? Check it by printing it out.</p>
<div class="practice">
<p>Copy-paste and test <span class="program-function">Accumulator</span> class code in a Jupiter notebook.</p>
</div>
</section><section id="flexible-accumulator-with-a-subtract-method" class="level3" data-number="9.2.7"><h3 data-number="9.2.7" class="anchored" data-anchor-id="flexible-accumulator-with-a-subtract-method">
<span class="header-section-number">9.2.7</span> Flexible accumulator with a <code>subtract</code> method</h3>
<p>Now lets us create a new class that is a <em>descendant</em> of the <code>Accumulator</code>. We will call it <code>FlexibleAccumulator</code> as it will allow you to also <em>subtract</em> from the total count. You specify ancestors (could be more than one!) in round brackets after the class name</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FlexibleAccumulator(Accumulator):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span> <span class="co"># You must have at least one non-empty line, and pass means "do nothing"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now you have a new class that is a descendant of <code>Accumulator</code> but, so far, is a perfect copy of it. Add <code>subtract</code> method to the class. It should subtract <code>1</code> from the <code>.total</code> property (don’t forget to <em>document</em> it!). Check that it works. Create one instance of <code>Accumulator</code> and another one of <code>FlexibleAccumulator</code> class and check that you can call <code>add()</code> on both of them but <code>subtract()</code> only for the latter.</p>
<div class="practice">
<p>Add <span class="program-function">subtract</span> method to the <span class="program-function">FlexibleAccumulator</span> class in a Jupiter notebook. Add testing.</p>
</div>
</section></section><section id="method-arguments" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="method-arguments">
<span class="header-section-number">9.3</span> Method arguments</h2>
<p>Now, create a new class <code>SuperFlexibleAccumulator</code> that will be able to both <code>add()</code> and <code>subtract()</code> an <em>arbitrary</em> value. Think about which class it should inherit from. Redefine both <code>.add()</code> and <code>.subtract()</code> method in that new class by adding <code>value</code> argument to both method and add/subtract this value rather than <code>1</code>. Note that now you have <em>two</em> arguments in each method <code>(self, value)</code> but when you call you only need to pass the latter (again, <code>self</code> is passed automatically). Don’t forget to document <code>value</code> argument (but you do not need to document <code>self</code> as its meaning is fixed).</p>
<div class="practice">
<p>Create <span class="program-function">SuperFlexibleAccumulator</span> class and define super flexible <span class="program-function">add</span> and <span class="program-function">subtract</span> methods that have <span class="program-function">value</span> parameter ( in a Jupiter notebook). Test them!</p>
</div>
<section id="constructor-arguments" class="level3" data-number="9.3.1"><h3 data-number="9.3.1" class="anchored" data-anchor-id="constructor-arguments">
<span class="header-section-number">9.3.1</span> Constructor arguments</h3>
<p>Although constructor <code>__init(...)__</code> is special, it is still a method. Thus, you can pass arguments to it just like you did it for other methods. You pass these arguments when you create an object, so in our case, you put it inside the bracket for <code>counter = SuperFlexibleAccumulator(...)</code>.</p>
<p>Modify the code so that you pass the initial value that total is set to, instead of zero.</p>
<div class="practice">
<p>Add [initial_value] parameter to the constructor of the <span class="program-function">SuperFlexibleAccumulator</span> class in a Jupiter notebook. Test it!</p>
</div>
</section><section id="calling-methods-from-other-methods" class="level3" data-number="9.3.2"><h3 data-number="9.3.2" class="anchored" data-anchor-id="calling-methods-from-other-methods">
<span class="header-section-number">9.3.2</span> Calling methods from other methods</h3>
<p>You can call a function or object’s method at any point of time, so, logically, you can use methods inside methods. Let’s modify our code, realizing that <em>subtracting</em> a value is like <em>adding a negative</em> value. Modify your code, so that <code>.subtract()</code> only negates the value before passing it to <code>.add()</code> for actual processing. Thus, <code>total</code> is modified <em>only</em> inside the <code>add()</code> method.</p>
<div class="practice">
<p>Modify <span class="program-function">subtract()</span> method of <span class="program-function">SuperFlexibleAccumulator</span> to utilize <span class="program-function">add()</span> in a Jupiter notebook. Test it!</p>
</div>
</section><section id="local-variables" class="level3" data-number="9.3.3"><h3 data-number="9.3.3" class="anchored" data-anchor-id="local-variables">
<span class="header-section-number">9.3.3</span> Local variables</h3>
<p>Just like normal functions, you methods can have local variables. They are local (visible and accessible only from within the method) and are not persistent (their values do not survive between the calls). Conceptually, you separate variables that need to be persistent (retain their value the whole time object exists) as attributes/properties and temporary variables that are need only for the computation itself as local method variables. What would be value of property <code>.total</code> in this example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Accumulator:</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, initial):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">=</span> initial <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.total <span class="op">=</span> initial</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> Accumulator(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What about in this case?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Accumulator:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, initial):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">=</span> initial <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.total <span class="op">=</span> temp</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> Accumulator(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section><section id="flappy-bird-the-humble-beginnings" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="flappy-bird-the-humble-beginnings">
<span class="header-section-number">9.4</span> Flappy Bird: the humble beginnings</h2>
<p>We will start with a basic scaffolding for our program. Download the <a href="material/Blue-Bird.png">bird image</a><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> and put it into a folder where you will store the code. Create a basic code that uses <a href="settings-files">settings file</a> that defines minimal setting for a window (size) and a bird (image file). Organize it hierarchically, as follows, as this will help us keep settings for different classes organized.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Bird"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"Image"</span> <span class="fu">:</span> <span class="st">"Blue-Bird.png"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Window"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"Size"</span><span class="fu">:</span> <span class="ot">[</span><span class="dv">800</span><span class="ot">,</span> <span class="dv">600</span><span class="ot">]</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Create a <a href="https://psychopy.org/api/visual/window.html#psychopy.visual.Window">window</a> using this specified size and an <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> using the filename from the settings file. Add a basic game loop in which you repeatedly draw the bird (should appear right at the center of the screen) and check for a key press (<em>escape</em> should exit the game).</p>
<div class="program">
<p>Put your code into <span class="program-filename">code01.py</span>.</p>
</div>
</section><section id="flappy-bird-class" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="flappy-bird-class">
<span class="header-section-number">9.5</span> Flappy Bird class</h2>
<p>Our flappy bird is, effectively, an image but we would like it to have additional behaviors, like, automatically falling down due to gravity, flying up due to flapping its wings, etc. There are several way we can do this. We can keep the image in <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> and write additional functions to handle it (the way we did previously). We could create an new class <code>FlappyBird</code> that will have the <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> as its attribute. Or, we could utilize the power of inheritance and build <code>FlappyBird</code> class on top of the <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a>. This means less work for us, so that is the path we will follow.</p>
<p>Create a new file that will contain your <code>FlappyBird</code> class. Here is how it should look like:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""Your comment on what this file contains.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># import libraries, which ones do you need?</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FlappyBird(visual.image.ImageStim):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">  FlappyBird class based on ImageStim</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, win, settings):</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Constructor.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">super</span>().<span class="fu">__init__</span>(win, image<span class="op">=</span>settings[<span class="st">"Image"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the code above, I defined <code>FlappyBird</code> as a descendant of the <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>. To make the latter work, we need to initialize it properly by calling it constructor. This is what <code>super().__init__(...)</code> call does: Calls constructor of the ancestor class (<code>super()</code> refers to the immediate ancestor) to enable all the magic that we want to reuse. Recall that <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a> needs at least two parameters: a PsychoPy <a href="(https://psychopy.org/api/visual/window.html#psychopy.visual.Window)">window</a> that the stimulus will belong to and an image (a filename in this case). Here, I assume that when I create a bird object (call the constructor), I pass <em>two</em> parameters (again, <code>self</code> comes “for free”, so you do not pass it explicitly but assume that it is the <em>first</em> argument that you get): the [window]((https://psychopy.org/api/visual/window.html#psychopy.visual.Window) that we created plus a dictionary with settings for the bird (there will be more settings, so it would be practical to pass the whole dictionary instead of passing one parameter at a time).</p>
<p>Copy paste that code (plus add appropriate imports and comments) and use <code>FlappyBird</code> class instead of <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a>. Note that <code>FlappyBird</code> inherits <em>all</em> its functionality from <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a>, so, apart from how you create it, you can use it in exactly the same way. Meaning, you do not need to modify anything else in your code (told you, it would save us time and effort!).</p>
<div class="program">
<p>Put <span class="program-function">FlappyBird</span> class code into a separate file. Use it instead of <span class="program-function">ImageStim</span> in <span class="program-filename">code02.py</span>.</p>
</div>
</section><section id="a-properly-sized-bird" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="a-properly-sized-bird">
<span class="header-section-number">9.6</span> A properly-sized bird</h2>
<p>Our bird is very cute but is way too large. Add a new setting for it (I suggest calling is <code>Size</code> and setting it to 0.1) and then use it inside the constructor adding <code>size=...</code> to <code>super().__init__</code> call. Do you need to change anything in the main code?</p>
<div class="program">
<p>Add bird size setting. Use it in <span class="program-function">FlappyBird</span> class constructor.</p>
</div>
</section><section id="flappy-bird-is-falling-down-my-dear-lady" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="flappy-bird-is-falling-down-my-dear-lady">
<span class="header-section-number">9.7</span> Flappy Bird is falling down (my dear lady)</h2>
<p>Before our bird flies, it needs to learn how to fall down. Falling down is just a change of bird’s vertical position based on bird’s vertical speed. We already have a property for the (horizontal and) vertical position: <code>self.pos</code>, a tuple with <code>(x, y)</code> position of the center of the image. But we do need an additional new attribute that would encode bird’s vertical speed. Create it in the constructor (if you forgot how to do it, take a look above on how we create the <code>total</code> attribute for <code>Accumulator</code> class) and call it <code>vspeed</code>. Also, create a new setting (I would call it <code>"Initial vertical speed"</code>) and set it to <code>-0.01</code>, use this setting in the constructor to initialize <code>vspeed</code>.</p>
<p>Now we also need a method that would update bird’s position based on its (current) speed. Create this method below the constructor (does it need any parameters beyond compulsory <code>self</code>?). It should simply compute <span class="math inline">\(y_{new} = y + vspeed\)</span> and assign <span class="math inline">\(y_{new}\)</span> back to <code>pos</code> attribute (note that you cannot assign only y coordinate, you have to pass the tuple <code>(x, y)</code> reusing original <code>x</code> value from <code>pos</code>). Do not forget to document the new method!</p>
<p>Now you need to call the <code>update_per_frame()</code> on <em>each</em> frame before drawing the bird. This should make your bird fall of the screen! (Experiment with <code>"Initial vertical speed"</code> setting to make it fall faster or slower or even upwards!)</p>
<div class="program">
<p>Update <span class="program-function">FlappyBird</span> class. Use <span class="program-function">update_per_frame</span> method in <span class="program-filename">code03.py</span>.</p>
</div>
</section><section id="timing-the-fall" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="timing-the-fall">
<span class="header-section-number">9.8</span> Timing the fall</h2>
<p>Currently, the speed of our bird’s fall is measured in norm units per <em>frame</em>. This works but these are not the most convenient units to think in. Plus, it relies on PsychoPy (and the rest of our code) to ensure that time between individual frames is exactly the same. This is <em>mostly</em> the case and an occasionally slow bird is not a big problem for a game. However, that might be a problem for an actual experiment that requires precise timing of movement. Thus, we need to think about vertical speed in units of norm units per <em>second</em> and measure time between calls ourselves.</p>
<p>Create a new <a href="https://psychopy.org/api/clock.html#psychopy.clock.Clock">Clock</a> attribute that will count the time elapsed since it last reset (I would call it <code>frame_timer</code>). Create an <code>update()</code> method to compute <span class="math inline">\(y_{new} = y + vspeed * T_{elapsed}\)</span>, where <span class="math inline">\(T_{elapsed}\)</span> is the time elapsed between frames. Do not forget to reset the timer! (What will happen if you do forget?)</p>
<p>Now set your <code>"Initial vertical speed"</code> to some reasonable value (e.g., 0.5) and check that the time it takes for the bird to fall of the screen looks reasonable (for 0.5 norm units / second it should be off the screen in two seconds).</p>
<div class="program">
<p>Update <span class="program-function">FlappyBird</span> class with a timer and <span class="progam-function">update</span> method. Use <span class="progam-function">update</span> instead of <span class="progam-function">update_per_frame</span> in <span class="program-filename">code04.py</span>.</p>
</div>
</section><section id="it-is-all-newtons-fault" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="it-is-all-newtons-fault">
<span class="header-section-number">9.9</span> It is all Newton’s fault</h2>
<p>Now let us add gravity, so that the speed of falling would be constantly changing. Create a new setting and call it <code>"Gravity"</code>. Set it to <code>-0.5</code> (units are <code>norm units per second squared</code>) but experiment with different values later on. Acceleration due to gravity changes vertical speed just like speed itself changes the vertical position<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Update your <code>update</code> method to change the speed based on acceleration given the elapsed time. What do you need to update first, the speed or the location? Also, think about how you will store the acceleration: It is in settings parameter that exists only in the constructor. You can either store it in a new attribute or store all settings in an attribute for later use.</p>
<div class="program">
<p>Update <span class="program-function">FlappyBird</span> class with acceleration due to gravity.</p>
</div>
</section><section id="flap-bird-flap" class="level2" data-number="9.10"><h2 data-number="9.10" class="anchored" data-anchor-id="flap-bird-flap">
<span class="header-section-number">9.10</span> Flap bird, flap!</h2>
<p>Let us add ability of the bird to “flap” in order to stay in the air. First, create a new setting <code>Flap speed</code> and set it to <code>0.4</code> (as usual, feel free to experiment!). Add a new method <code>.flap(self)</code> and inside simply set <code>vspeed</code> to <code>Flap speed</code>. Thus, a single flap sets the bird flying up with <code>Flap speed</code> speed which, however, will be constantly reduced by the acceleration due to <code>Gravity</code> so the bird will eventually start falling down again.</p>
<p>In the main code, check for <code>"escape"</code> and <code>"space"</code> keys. If the latter is pressed, call <code>.flap()</code> method of the bird. Check that you can keep the on the screen by timing the space button presses or can make it fly upwards off the screen.</p>
<div class="program">
<p>Add <span class="program-function">flap</span> method to <span class="program-function">FlappyBird</span> class. Use it in <span class="program-filename">code04.py</span> whenever player presses <em>space</em>.</p>
</div>
</section><section id="stay-off-the-ground" class="level2" data-number="9.11"><h2 data-number="9.11" class="anchored" data-anchor-id="stay-off-the-ground">
<span class="header-section-number">9.11</span> Stay off the ground</h2>
<p>In our game, the player can lose either if they hit an obstacle (we do not have any yet) or if the bird drops below the ground level, i.e., the bottom edge of the window. Create a new method <code>is_airborne()</code> that will return <code>True</code> if <code>y</code> position of the bird is above <code>-1</code> (note, you do not need an explicit <code>if</code> for this, nor do you need to write <code>True</code> or <code>False</code> anywhere, think how this can be done without these).</p>
<p>In the main loop add the check for <code>bird.is_airborne()</code> condition so that it continues until player presses <code>"escape"</code> or the bird hits the ground.</p>
<div class="program">
<p>Add <span class="program-function">is_airborne</span> method to <span class="program-function">FlappyBird</span> class. Use it in <span class="program-filename">code06.py</span> as an additional condition for the game loop.</p>
</div>
</section><section id="computed-attribute-property" class="level2" data-number="9.12"><h2 data-number="9.12" class="anchored" data-anchor-id="computed-attribute-property">
<span class="header-section-number">9.12</span> Computed attribute <code>@property</code>
</h2>
<p>As was explained the in “Object-oriented programming” section above, properties describe state of an object, whereas methods describe what an object can do or what you do to an object. Our <code>is_airborne()</code> method breaks this logic: It describes the <em>state</em> of the bird but we <em>call</em> it (use it) as a method. What we have here is a <em>computed</em> property that is inferred from other properties of an object. In our case, we infer property <code>is_airborne</code> from <code>y</code>. We could, of course, make <code>is_airborne</code> into a real property by defining it in the constructor and then updating it inside <code>update()</code> method. However, we will instead use a cool feature called <a href="https://www.python.org/dev/peps/pep-0318/">decorators</a> to turn a method into a read-only property. The only thing you need to do is to add <code>@property</code> decorator right above the <code>def is_airborne(self):</code> line and drop brackets when using it in the main loop (so just <code>bird.is_airborne</code> instead of <code>bird.is_airborne()</code>).</p>
<p><code>@property</code> tells Python that the method right below <strong>will</strong> (must!) return a value and that outside world should see it not as a method but as a <em>property</em>. You can use it to make properties read-only, so that they could not be (easily) changed from outside or to create properties that are computed on-the-fly as in our example.</p>
<p>Note that difference is not so much of practical implementation (changes we made to the code were minimal) but of a conceptual nature: Object’s states should be properties not methods. In our small example this may look like an overkill but in a moderately complex project even small conceptual blurring of lines could make it harder to understand the code.</p>
<div class="program">
<p>Turn <span class="program-function">is_airborne</span> into a property. Use it as property in <span class="program-filename">code07.py</span>.</p>
</div>
</section><section id="an-opening-in-an-obstacle" class="level2" data-number="9.13"><h2 data-number="9.13" class="anchored" data-anchor-id="an-opening-in-an-obstacle">
<span class="header-section-number">9.13</span> An opening in an obstacle</h2>
<p>We aim of the game is for the bird to fly avoiding obstacles. An obstacle consist of two rectangle, one that protrudes from above and another one from below. The opening between them gives the bird an opportunity to fly through. So let us begin by writing a code (in the Jupyter notebook) that would generate a random opening, characterized by <code>y_bottom</code> and <code>y_top</code> based on four parameters:</p>
<ul>
<li>
<code>lower_margin</code> : lowest possible position of the bottom of the opening relative to the bottom of the screen, i.e., the <code>y_bottom</code> cannot be closer to -1 than that.</li>
<li>
<code>upper_margin</code> : higher possible position of the top of the opening relative to the top of the screen, i.e., the <code>y_top</code> cannot be closer to 1 than that.</li>
<li>
<code>min_size</code> : the minimal size of the opening, i.e., minimal distance between <code>y_top</code> and <code>y_bottom</code>.</li>
<li>
<code>max_size</code> : the maximal size of the opening, i.e., maximal distance between <code>y_top</code> and <code>y_bottom</code>.</li>
</ul>
<p>Write a code that assume certain values for each parameter (e.g., <code>lower_margin = 0.2</code>, <code>upper_margin = 0.2</code>, <code>min_size = 0.2</code>, <code>max_size = 0.4</code>) and generates a random pair <code>(y_bottom, y_top)</code> that satisfies the conditions.</p>
<div class="practice">
<p>Write a random opening code in a Jupiter notebook.</p>
</div>
</section><section id="an-obstacle" class="level2" data-number="9.14"><h2 data-number="9.14" class="anchored" data-anchor-id="an-obstacle">
<span class="header-section-number">9.14</span> An obstacle</h2>
<p>Now let us create an <code>Obstacle</code> class (put it into a separate file). It will consist of two rectangles, one protruding from the top and the other one from the bottom, with a random opening in between. At the moment you need six settings to describe an <code>Obstacle</code>: The four parameters that define a random opening plus a width of rectangles and their color. Describe them as a separate group in the settings files (probably under <code>"Obstacles"</code>) and pass them to the constructor of the <code>Obstacle</code> class.</p>
<p>In the constructor, generate a random opening (you have the code for this already) and create the two rectangles both <code>width</code> wide, one going from the top till <code>y_top</code>, another one from the bottom till <code>y_bottom</code>. Place both horizontally at the right edge of the window but so you could see them. Decide on how you will store the two rectangles, you can put them into two different attributes (e.g., <code>upper_rect</code> and <code>lower_rect</code>) or have them in a list. I would suggest the latter approach, as it will simplify your future code. Think about which parameters you need for the <code>__init__()</code> constructor function.</p>
<p>You also will need a <code>draw()</code> method that simply draws both rectangles. Implement the class in a separate file, then create and draw a single obstacle in the main code to check that it looks right.</p>
<div class="program">
<p>Create <span class="program-function">Obstacle</span> class in a separate file. Use it in <span class="program-filename">code08.py</span>.</p>
</div>
</section><section id="a-moving-obstacle" class="level2" data-number="9.15"><h2 data-number="9.15" class="anchored" data-anchor-id="a-moving-obstacle">
<span class="header-section-number">9.15</span> A moving obstacle</h2>
<p>Conceptually, our bird fly towards an obstacle but instead we will induce perception of its motion by moving obstacles from right to left. Define a new <code>speed</code> setting for an <code>Obstacle</code> class, it should be in <code>norm units per second</code> and create an <code>update</code> method that would change horizontal position of both rectangles based on the amount of time that passed between the calls. This is similar to how we updated bird’s position based on its speed, so follow the same logic and think about which additional attributes you require and how you store and use any relevant information.</p>
<p>Call <code>update()</code> at the same place that you update bird’s location in the main loop and check that the obstacle is moving from right to left.</p>
<div class="program">
<p>Add <span class="program-function">update</span> method to <span class="program-function">Obstacle</span> class. Use it in <span class="program-filename">code09.py</span>.</p>
</div>
</section><section id="hitting-the-wall" class="level2" data-number="9.16"><h2 data-number="9.16" class="anchored" data-anchor-id="hitting-the-wall">
<span class="header-section-number">9.16</span> Hitting the wall</h2>
<p>At the moment, our bird is flying through the obstacle like it is not there. But it is! Luckily for us, PsychoPy makes implementing this very easy, as it can check whether two stimuli overlap using <a href="https://psychopy.org/api/visual/shapestim.html#psychopy.visual.ShapeStim.overlaps">overlaps()</a> method of one of them (and the second stimulus is passed as an argument).</p>
<p>Thus, to check whether the bird hit the wall, we just need to create a method (let us call it <code>check_if_hit</code>) in an <code>Obstacle</code> class that will take a bird object and check whether it <a href="https://psychopy.org/api/visual/shapestim.html#psychopy.visual.ShapeStim.overlaps">overlaps()</a> with one of the rectangles. Remember, our <code>FlappyBird</code> is a descendant of the <a href="https://psychopy.org/api/visual/imagestim.html#psychopy.visual.ImageStim">ImageStim</a>, so we can pass it to the <a href="https://psychopy.org/api/visual/shapestim.html#psychopy.visual.ShapeStim.overlaps">overlaps()</a> method directly (advantage of using the inheritance!)</p>
<p>In the main game loop, add the check for the bird <em>not</em> hitting the obstacle to the main condition (so now you should have three things to check for). Test your code by flying the bird into the wall. Also, by flying your bird through the opening. Note that if our settings make it too tricky, modify them to make the opening larger.</p>
<div class="program">
<p>Add <span class="program-function">check_if_hit</span> method to <span class="program-function">Obstacle</span> class. Use it in <span class="program-filename">code10.py</span>.</p>
</div>
</section><section id="an-obstacle-manager" class="level2" data-number="9.17"><h2 data-number="9.17" class="anchored" data-anchor-id="an-obstacle-manager">
<span class="header-section-number">9.17</span> An obstacle manager</h2>
<p>A game with a single obstacle is no fun but before we add more, we need a class that will manage them for us. Let us call it <code>ObstaclesManager</code>. For the moment, it will simply wrap up all functionality that we implemented in the main script. In the constructor, it should create a <em>list</em> attribute for obstacle objects and add a first one, it should also implement methods <code>draw()</code>, <code>update()</code>, and <code>check_if_hit()</code> that draws, updates, and checks for an overlap with a bird for <em>all</em> obstacles on the list. For the moment we will still have just one of them in the list but implementing things in the loop means it will be easier to add more. Create the class and then use it in the main script.</p>
<p>There should be no actual changes of how the game plays, just the code refactoring. However, it helps us to hide the management part from the main script (making it easier to understand) and, if you did everything correctly, the code should “just work” once you replace <code>Obstacle</code> with <code>ObstaclesManager</code> object.</p>
<div class="program">
<p>Create <span class="program-function">ObstaclesManager</span> class. Use it in <span class="program-function">code11.py</span>.</p>
</div>
</section><section id="loads-of-obstacles" class="level2" data-number="9.18"><h2 data-number="9.18" class="anchored" data-anchor-id="loads-of-obstacles">
<span class="header-section-number">9.18</span> Loads of obstacles</h2>
<p>Now we are ready to add more obstacles. You need to update the <code>update</code> method of the <code>ObstaclesManager</code> so that it adds a new obstacle to the list after a random time interval. Define a new setting <code>Spawn time</code>, a list of two values that define a minimal and maximal time between spawns, and create a <a href="https://psychopy.org/api/clock.html#psychopy.clock.CountdownTimer">CountdownTimer</a> (or a <a href="https://psychopy.org/api/clock.html#psychopy.clock.Clock">Clock</a>, remember they differ only in whether time is subtracted or added) attributed. Whenever the timer is up, add a new obstacle to the list, generate a new delay, and set the timer again. Note that now you need settings and a Window in the <code>update</code> because they are required for creating a new obstacle. Think how you can store them for later use in the constructor.</p>
<p>Do you need to change anything in the main script? Check that more obstacles appear over time!</p>
<div class="program">
<p>Update <span class="program-function">update</span> of the <span class="program-function">ObstaclesManager</span> class.</p>
</div>
</section><section id="removing-redundant-obstacles" class="level2" data-number="9.19"><h2 data-number="9.19" class="anchored" data-anchor-id="removing-redundant-obstacles">
<span class="header-section-number">9.19</span> Removing redundant obstacles</h2>
<p>Once the obstacle is past the left edge of the screen (its x-axis position is less than <code>-1</code>) we need to remove it from the list. Otherwise, we will waste a lot of time and memory keeping track and drawing obstacles that are neither relevant, nor visible. Think about how you would implement this before reading further.</p>
<p>First, we need to compute the horizontal position of an obstacle. You can deduce it from <code>pos</code> attribute of one of the rectangles and implement this use of attribute (<code>pos</code> of <code>Obstacle</code>) of an attribute (<code>obstacles</code> of <code>ObstaclesManager</code>) directly. However, working with attributes of attributes makes code harder to read and to maintain. Instead, add a new computed property <code>x</code> to <code>Obstacle</code> class that would return a single number (horizontal position) using <code>@property</code> decorator we used for the bird’s <code>is_airborne</code> dynamic attribute.</p>
<p>Update the <code>update</code> method of the <code>ObstaclesManager</code> to check the position the <em>first</em> obstacle in the list. If it less than -1, simply <a href="https://docs.python.org/3.1/tutorial/datastructures.html">pop</a> it from the list. Why the first one? Because any other obstacle in the list was added later and, therefore, must be further to the right. Why <em>only</em> the first one? If we assume both a reasonable motion speed and a reasonable spawn delay, it is very unlikely that more than one obstacles reaches the left edge at the same time.</p>
<p>Note that for safety reasons, you must first check that the <code>obstacles</code> attribute is not empty! Hint, when used in a conditional statement directly, empty list evaluates to <code>False</code>. Debug the code to make sure that obstacles are indeed removed. You can either use a different cut-off point (e.g., -0.25) to see that easier or put a break point at the line that pops the redundant obstacle (better still, do both!)</p>
<div class="program">
<p>Update <span class="program-function">update</span> of the <span class="program-function">ObstaclesManager</span> class.</p>
</div>
</section><section id="keeping-the-score" class="level2" data-number="9.20"><h2 data-number="9.20" class="anchored" data-anchor-id="keeping-the-score">
<span class="header-section-number">9.20</span> Keeping the score</h2>
<p>It is hard to brag about your bird-flying skills, if you do not how many obstacles did you fly through. Let us add the score! First, create a <a href="https://psychopy.org/api/visual/textstim.html#psychopy.visual.TextStim">TextStim</a> (call it <code>score_text</code>) and put it somewhere one the screen, e.g., a top-left or top-right corner. Initialize its text to <code>"0"</code>. Draw it in the main loop. Make sure it works before you continue.</p>
<p>To keep the score, we need to count the number of obstacles that the bird clears on every frame and add it to the total score. As with the removal of redundant obstacles, it will be either zero or one obstacle that crossed the middle of the screen. But in this case, it is not the leftmost that we have to check but the <em>leftmost</em> among those that did not yet cross the mid-line. There are different way you can approach this, so think how you would approach this before reading on. And if you came up with a different plan, by all means – implement it!</p>
<p>My way of doing this is to introduce a new attribute <code>scored = False</code> and a method <code>score()</code> to the <code>Obstacle</code> class. In the <code>score()</code> method, if the object crossed the <code>0</code> line <em>and</em> has not been scored, it marked as <code>scored</code> and the method returns <code>1</code>. Otherwise, the object was either already scored or did not cross the mid-line yet, so it returns <code>0</code>. Next, I added a <code>score()</code> method to the <code>ObstaclesManager</code> that simply computes the total score (sum of) scores of all obstacles in the list. In the main script this score is added to a <code>score</code> variable that, in turn, is used to update <code>score_text</code>.</p>
<div class="program">
<p>Update your code and use it in <span class="program-filename">code12.py</span>.</p>
</div>
</section><section id="a-foundation" class="level2" data-number="9.21"><h2 data-number="9.21" class="anchored" data-anchor-id="a-foundation">
<span class="header-section-number">9.21</span> A foundation</h2>
<p>This is just a foundation of a game, so feel free to add to it. Animated bird? Difficulty levels? Different kinds of obstacles? High-score table?</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>No, it is not déjà vu, I am repeating myself to remind you about the distinction.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><code>BaseVisualStim</code> does not actually define <code>draw()</code> method, only that it must be present.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Yes, it is really called “duck typing”.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>There are more special methods that you will learn about later, they all follow <code>__methodname__()</code> convention.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Again, you can use any name for that parameter but that will surely confuse everyone.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This is actually how all properties and methods are stored, in a <code>__dict__</code> attribute, so you can write <code>number_sum.__dict__["total"]</code> to get it.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>If you use a linter, it will complain whenever it sees a property not defined in the constructor<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Created by <a href="https://openclipart.org/artist/Scout">Madison Kingsford</a>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Note that even though you can import <code>ImageStim</code> from <code>visual</code>, it is a better idea to specify its submodule for inheritance: <code>visual.image.ImageStim</code>. Inheritance will work for <code>ImageStim</code> even without that extra <code>.image</code> bit but won’t work for some other stimuli due to so-called “laze loading” of classes. For these other classes, like <code>Rect</code>, you will get a very mysterious sounding error message, so it is better to always use full paths to the class when inheriting from them. You can find the full path in the “Details” section of documentation. E.g., the full path for <code>Rect</code> class is <a href="https://psychopy.org/api/visual/rect.html#details">psychopy.visual.rect.Rect</a><a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>I.e., speed is a derivative of position, and acceleration is a derivative of the speed<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/alexander-pastukhov\.github\.io\/learn-python-by-writing-games");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./08-christmas.html" class="pagination-link" aria-label="Christmas special">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>  <span class="chapter-title">Christmas special</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10-guitar-hero.html" class="pagination-link" aria-label="Guitar Hero">
        <span class="nav-page-text"><span class="chapter-number">10</span>  <span class="chapter-title">Guitar Hero</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>videojs(video_shortcode_videojs_video1);</script>
</body>
</html>
